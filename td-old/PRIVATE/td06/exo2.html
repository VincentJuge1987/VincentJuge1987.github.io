<!DOCTYPE html>
<html>
 <head>
   <meta charset="utf-8">
   <script>
     "use strict";
   
     function drawTicks(context, centerX, centerY, radius, n) {
       context.strokeStyle = "blue";
       context.lineWidth = 3;
       context.beginPath();
         
       var i;
       for(i = 0; i < n; i++) {
         var alpha = angle(i, n);
         var x1 = centerX + radius * 1.05 * Math.cos(alpha);
         var y1 = centerY + radius * 1.05 * Math.sin(alpha);
         var x2 = centerX + radius * 1.1 * Math.cos(alpha);
         var y2 = centerY + radius * 1.1 * Math.sin(alpha);
         
         context.moveTo(x1, y1);
         context.lineTo(x2, y2);
       }
       
       context.stroke();
     }
   
     function drawClock(canvas, radius) {
       var context = canvas.getContext("2d");
       context.clearRect(0, 0, canvas.width, canvas.height);
       drawTicks(context, canvas.width / 2, canvas.height / 2, radius, 24);
       
       context.strokeStyle = "blue";
       context.lineWidth = 3;
       context.beginPath();
       context.arc(canvas.width / 2, canvas.height / 2, radius * 1.1, 0, 2 * Math.PI);
       context.stroke();
     }
     
     function drawNeedle(canvas, angle, radius, ratio, color, thickness) {
       var x = canvas.width / 2 + ratio * radius * Math.cos(angle);
       var y = canvas.height / 2 + ratio * radius * Math.sin(angle);
     
       var context = canvas.getContext("2d");
       context.strokeStyle = color;
       context.lineWidth = thickness;
       context.beginPath();
       context.moveTo(canvas.width / 2, canvas.height / 2);
       context.lineTo(x, y);
       context.stroke();
     }
   
     function angle(value, max) {
       return (value  - max / 4) * (2 * Math.PI) / max;
     }
   
     function refresh(canvas) {
       var date = new Date();
       var seconds = date.getSeconds();
       var minutes = date.getMinutes();
       var hours = date.getHours();
       
       var radius = 2 / 6 * Math.min(canvas.width, canvas.height)
       drawClock(canvas, radius);
       
       drawNeedle(canvas, angle(hours, 24), radius, 0.7, "black", 4);
       drawNeedle(canvas, angle(minutes, 60), radius, 1.0, "black", 2);
       drawNeedle(canvas, angle(seconds, 60), radius, 1.0, "red", 2);
     }
     
     var triggers = [];
     
     function startClock(clockId) {
       var clock = document.getElementById(clockId);
       if (triggers.length == 0) {
         window.setInterval(function() {
           triggers.forEach(function(trigger) { trigger(); });
         }, 1000);
       }
       triggers.push(refresh.bind(undefined, clock));
     }
   </script>
 </head>
 <body>
  <h2>Horloge 2</h2>
  <canvas id="clock1"
          width="200"
          height="200">
  </canvas>
  <canvas id="clock2"
          width="300"
          height="400">
  </canvas>
  <script>
    startClock('clock1');
    startClock('clock2');
  </script>
 </body>
</html>
